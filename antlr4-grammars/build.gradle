apply from: "$rootDir/gradle/javaProject.gradle"
apply plugin: 'eclipse'

configurations {
	antlr4
	compile.extendsFrom antlr4
}

dependencies {
	antlr4 group: 'org.antlr', name: 'antlr4', version: '4.3'
}

task transpileExpr(type: com.github.appocalypse.build.antlr4.Antlr4Transpile) {
	source = files('grammars/expr')
	javaPackage = 'com.github.appocalypse.grammars.expr'
	antlr4Classpath = configurations.antlr4
}

compileJava {
	source = tasks.withType(com.github.appocalypse.build.antlr4.Antlr4Transpile)
}


eclipse {
	classpath {
		file {
			withXml {
				def node = it.asNode()
				// TODO: fix this dynamically
				node.appendNode('classpathentry', [kind: 'src', path: 'build/tmp/transpileExpr'])
			}
		}
	}
}